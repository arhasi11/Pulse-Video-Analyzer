<!DOCTYPE html>
<html>
<head>
  <title>Video Upload System</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    video { width: 300px; margin-top: 10px; }
    #progressBar {
      width: 100%;
      height: 20px;
      background: #ddd;
      margin-top: 10px;
      border-radius: 5px;
      overflow: hidden;
    }
    #progress {
      height: 100%;
      width: 0%;
      background: green;
      text-align: center;
      color: white;
      font-size: 12px;
      line-height: 20px;
    }
  </style>
</head>
<body>

<h2>ðŸŽ¥ Video Upload System</h2>

<input type="file" id="file" />
<button onclick="upload()">Upload</button>

<div id="progressBar">
  <div id="progress">0%</div>
</div>

<h3>Status</h3>
<p id="status">Waiting...</p>

<h3>Uploaded Videos</h3>
<div id="list"></div>

<script>
function upload() {
  const file = document.getElementById("file").files[0];
  if (!file) return alert("Select a file");

  const formData = new FormData();
  formData.append("video", file);

  const xhr = new XMLHttpRequest();

  xhr.upload.onprogress = function (e) {
    if (e.lengthComputable) {
      const percent = Math.round((e.loaded / e.total) * 100);
      document.getElementById("progress").style.width = percent + "%";
      document.getElementById("progress").innerText = percent + "%";
    }
  };

  xhr.onload = function () {
    if (xhr.status === 200) {
      document.getElementById("status").innerText = "Upload complete!";
      loadVideos();
    }
  };

  xhr.open("POST", "/upload");
  xhr.send(formData);
}

async function loadVideos() {
  const res = await fetch("/videos");
  const videos = await res.json();

  const list = document.getElementById("list");
  list.innerHTML = "";

  videos.forEach(v => {
    list.innerHTML += `
      <div>
        <b>${v.name}</b> - ${v.status}<br>
        <video src="/uploads/${v.name}" controls></video>
      </div>
    `;
  });
}

loadVideos();
</script>

</body>
</html>